"""
Criar Perfis RSECE em ficheiro HAP 5.1
======================================

Cria todos os perfis de utilização definidos no Anexo XV do RSECE
(Diário da República, 4 de Abril de 2006).

Gera um ficheiro .E3A modelo com todos os schedules pré-configurados.

Tipologias incluídas:
- Hipermercados
- Venda por Grosso
- Supermercados
- Centros Comerciais
- Pequenas Lojas
- Restaurantes
- Pastelarias
- Pronto-a-Comer
- Hotéis 4-5 Estrelas
- Hotéis 3 ou menos Estrelas
- Cinemas e Teatros
- Discotecas
- Bingos e Clubes Sociais
- Clubes Desportivos (com/sem piscina)
- Escritórios
- Bancos (Sede/Filial)
- Comunicações
- Bibliotecas
- Museus e Galerias
- Tribunais/Ministérios/Câmaras
- Estabelecimentos Prisionais
- Ensino (Básico/Superior)
- Saúde (com/sem internamento)

Usage:
    python criar_perfis_rsece.py <modelo_base.E3A> <output.E3A>
"""

import zipfile
import struct
import sys
import os
from typing import List, Dict, Tuple
from hap_schedule_library import (
    HAPSchedule, ScheduleProfile, ScheduleManager,
    create_simple_schedule, encode_schedule,
    SCHEDULE_RECORD_SIZE, SCHEDULE_TYPE_FRACTIONAL
)


# =============================================================================
# PERFIS RSECE - DADOS DO ANEXO XV
# =============================================================================

# Estrutura: {nome: {tipo: {dia: [24 valores horários]}}}
# Tipos: 'ocupacao', 'iluminacao', 'equipamento'
# Dias: 'seg_sex', 'sabados', 'dom_fer'

PERFIS_RSECE = {}

# -----------------------------------------------------------------------------
# HIPERMERCADOS
# -----------------------------------------------------------------------------
PERFIS_RSECE['Hipermercado'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,0,10,15,35,50,65,75,95,95,75,60,60,80,95,100,100,100,75,30],
        'sabados': [0,0,0,0,0,0,10,15,35,50,70,85,95,100,100,100,100,100,100,95,80,65,20,10],
        'dom_fer': [0,0,0,0,0,0,5,15,90,95,100,100,85,35,5,0,0,0,0,0,0,0,0,0],
    },
    'iluminacao': {
        'seg_sex': [15,15,15,15,15,15,35,70,75,90,90,90,90,90,90,90,90,90,100,100,100,100,100,15],
        'sabados': [15,15,15,15,15,15,35,70,75,90,90,90,90,90,90,90,90,90,100,100,100,100,100,15],
        'dom_fer': [15,15,15,15,15,15,35,70,15,90,90,90,90,90,15,15,15,15,15,15,15,15,15,15],
    },
    'equipamento': {
        'seg_sex': [15,15,15,15,15,90,100,85,95,65,75,70,40,45,45,45,60,55,45,50,45,40,35,35],
        'sabados': [15,15,15,15,15,90,100,85,95,65,75,70,40,45,45,45,60,55,45,50,45,40,35,35],
        'dom_fer': [15,15,15,15,15,90,100,85,95,65,75,70,40,15,15,15,15,15,15,15,15,15,15,15],
    },
}

# -----------------------------------------------------------------------------
# VENDA POR GROSSO
# -----------------------------------------------------------------------------
PERFIS_RSECE['Venda Grosso'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,0,10,15,35,50,65,75,95,95,75,60,60,80,95,100,100,100,75,30],
        'sabados': [0,0,0,0,0,0,10,15,35,50,70,85,95,100,100,100,100,100,100,95,80,65,20,10],
        'dom_fer': [0,0,0,0,0,0,5,15,90,95,100,100,85,35,5,0,0,0,0,0,0,0,0,0],
    },
    'iluminacao': {
        'seg_sex': [15,15,15,15,15,15,35,70,75,90,90,90,90,90,90,90,90,90,100,100,100,100,100,15],
        'sabados': [15,15,15,15,15,15,35,70,75,90,90,90,90,90,90,90,90,90,100,100,100,100,100,15],
        'dom_fer': [15,15,15,15,15,15,35,70,75,90,90,90,90,90,15,15,15,15,15,15,15,15,15,15],
    },
    'equipamento': {
        'seg_sex': [15,15,15,15,15,90,100,85,95,65,75,70,40,45,45,45,60,55,45,50,45,40,35,35],
        'sabados': [15,15,15,15,15,90,100,85,95,65,75,70,40,45,45,45,60,55,45,50,45,40,35,35],
        'dom_fer': [15,15,15,15,15,90,100,85,95,65,75,70,40,15,15,15,15,15,15,15,15,15,15,15],
    },
}

# -----------------------------------------------------------------------------
# SUPERMERCADOS
# -----------------------------------------------------------------------------
PERFIS_RSECE['Supermercado'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,0,10,15,35,50,65,75,95,95,75,60,60,80,95,100,100,100,75,30],
        'sabados': [0,0,0,0,0,0,10,15,35,50,70,85,95,100,100,100,100,100,100,95,80,65,20,10],
        'dom_fer': [0,0,0,0,0,0,10,15,35,50,70,85,95,100,100,100,100,100,100,95,80,65,20,10],
    },
    'iluminacao': {
        'seg_sex': [15,15,15,15,15,15,35,70,75,90,90,90,90,90,90,90,90,90,100,100,100,100,15,15],
        'sabados': [15,15,15,15,15,15,35,70,75,90,90,90,90,90,90,90,90,90,100,100,100,100,15,15],
        'dom_fer': [15,15,15,15,15,15,35,70,75,90,90,90,90,90,90,90,90,90,100,100,100,100,15,15],
    },
    'equipamento': {
        'seg_sex': [15,15,15,15,15,95,100,85,95,65,75,70,40,45,45,45,60,55,45,50,45,40,15,15],
        'sabados': [15,15,15,15,15,95,100,85,95,65,75,70,40,45,45,45,60,55,45,50,45,40,15,15],
        'dom_fer': [15,15,15,15,15,95,100,85,95,65,75,70,40,45,45,45,60,55,45,50,45,40,15,15],
    },
}

# -----------------------------------------------------------------------------
# CENTROS COMERCIAIS
# -----------------------------------------------------------------------------
PERFIS_RSECE['Centro Comercial'] = {
    'ocupacao': {
        'seg_sex': [30,25,5,5,5,5,5,5,20,35,35,50,95,95,95,80,70,70,80,95,95,95,95,40],
        'sabados': [30,25,5,5,5,5,5,5,20,35,45,50,95,100,100,95,95,85,85,95,100,100,95,40],
        'dom_fer': [30,25,5,5,5,5,5,5,20,35,45,50,95,100,100,100,100,95,95,95,100,100,95,40],
    },
    'iluminacao': {
        'seg_sex': [50,40,20,20,20,20,20,40,70,70,100,100,100,100,100,100,100,100,100,100,100,100,100,50],
        'sabados': [50,40,20,20,20,20,20,40,70,70,100,100,100,100,100,100,100,100,100,100,100,100,100,50],
        'dom_fer': [50,40,20,20,20,20,20,40,70,70,100,100,100,100,100,100,100,100,100,100,100,100,100,50],
    },
    'equipamento': {
        'seg_sex': [40,15,15,15,15,15,15,15,60,60,100,100,100,100,100,100,100,100,100,100,100,100,100,40],
        'sabados': [40,15,15,15,15,15,15,15,60,60,100,100,100,100,100,100,100,100,100,100,100,100,100,40],
        'dom_fer': [40,15,15,15,15,15,15,15,60,60,100,100,100,100,100,100,100,100,100,100,100,100,100,40],
    },
}

# -----------------------------------------------------------------------------
# PEQUENAS LOJAS
# -----------------------------------------------------------------------------
PERFIS_RSECE['Pequena Loja'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,0,0,0,30,90,90,90,40,40,90,90,90,95,100,15,0,0,0,0],
        'sabados': [0,0,0,0,0,0,0,0,30,90,90,90,40,40,90,90,90,95,100,15,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'iluminacao': {
        'seg_sex': [5,5,5,5,5,5,5,5,25,100,100,100,50,50,95,100,100,100,100,30,5,5,5,5],
        'sabados': [5,5,5,5,5,5,5,5,25,100,100,100,50,50,95,100,100,100,100,30,5,5,5,5],
        'dom_fer': [5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],
    },
    'equipamento': {
        'seg_sex': [5,5,5,5,5,5,5,5,50,100,90,90,45,45,90,90,90,90,90,5,5,5,5,5],
        'sabados': [5,5,5,5,5,5,5,5,50,100,90,90,45,45,90,90,90,90,90,5,5,5,5,5],
        'dom_fer': [5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],
    },
}

# -----------------------------------------------------------------------------
# RESTAURANTES
# -----------------------------------------------------------------------------
PERFIS_RSECE['Restaurante'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,0,0,0,5,5,20,50,100,90,40,20,25,35,75,75,75,50,35,20],
        'sabados': [0,0,0,0,0,0,0,0,5,5,20,45,50,50,35,20,25,35,75,85,85,65,55,35],
        'dom_fer': [0,0,0,0,0,0,0,0,5,5,10,20,25,25,15,20,25,35,55,65,70,35,20,20],
    },
    'iluminacao': {
        'seg_sex': [0,0,0,0,0,0,20,40,60,60,90,100,100,100,95,90,90,90,95,95,100,100,80,50],
        'sabados': [0,0,0,0,0,0,20,30,55,55,75,80,95,95,85,85,85,90,95,100,100,100,100,70],
        'dom_fer': [5,0,0,0,0,0,15,30,45,50,60,75,95,95,70,60,60,60,75,95,100,90,50,30],
    },
    'equipamento': {
        'seg_sex': [45,45,45,45,45,45,60,70,85,90,95,100,100,90,90,90,90,90,90,100,100,100,80,50],
        'sabados': [45,45,45,45,45,45,50,60,70,75,80,85,90,85,80,85,80,90,95,100,100,100,95,70],
        'dom_fer': [45,45,45,45,45,45,55,60,65,75,90,95,95,95,95,80,55,55,75,80,80,75,60,30],
    },
}

# -----------------------------------------------------------------------------
# PASTELARIAS
# -----------------------------------------------------------------------------
PERFIS_RSECE['Pastelaria'] = {
    'ocupacao': {
        'seg_sex': [5,5,5,5,60,60,90,100,100,95,90,80,95,95,95,80,85,90,100,100,85,25,5,5],
        'sabados': [5,5,5,5,60,60,90,100,100,95,90,80,95,95,95,80,85,90,100,100,85,25,5,5],
        'dom_fer': [5,5,5,5,60,60,90,100,100,95,90,80,95,95,95,80,85,90,100,100,85,25,5,5],
    },
    'iluminacao': {
        'seg_sex': [5,5,5,5,90,100,100,100,100,90,90,95,95,90,90,90,90,100,100,100,80,25,5,5],
        'sabados': [5,5,5,5,90,100,100,100,100,90,90,95,95,90,90,90,90,100,100,100,80,25,5,5],
        'dom_fer': [5,5,5,5,90,100,100,100,100,90,90,95,95,90,90,90,90,100,100,100,80,25,5,5],
    },
    'equipamento': {
        'seg_sex': [50,50,50,50,100,100,100,100,95,85,85,100,100,75,60,60,95,100,60,85,50,50,50,50],
        'sabados': [50,50,50,50,100,100,100,100,95,85,85,100,100,75,60,60,95,100,60,85,50,50,50,50],
        'dom_fer': [50,50,50,50,100,100,100,100,95,85,85,100,100,75,60,60,95,100,60,85,50,50,50,50],
    },
}

# -----------------------------------------------------------------------------
# PRONTO-A-COMER
# -----------------------------------------------------------------------------
PERFIS_RSECE['Pronto-a-Comer'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,5,5,90,15,25,25,90,100,100,70,25,30,35,55,100,100,85,35,30],
        'sabados': [0,0,0,0,0,5,5,90,15,25,25,90,100,100,70,25,30,35,55,100,100,85,35,30],
        'dom_fer': [0,0,0,0,0,5,5,90,15,25,25,90,100,100,70,25,30,35,55,100,100,85,35,30],
    },
    'iluminacao': {
        'seg_sex': [0,0,0,0,0,65,70,100,100,85,85,100,100,100,80,80,80,80,100,100,100,100,50,10],
        'sabados': [0,0,0,0,0,65,70,100,100,85,85,100,100,100,80,80,80,80,100,100,100,100,50,10],
        'dom_fer': [0,0,0,0,0,65,70,100,100,85,85,100,100,100,80,80,80,80,100,100,100,100,50,10],
    },
    'equipamento': {
        'seg_sex': [50,50,50,50,50,50,50,100,100,100,100,100,100,100,75,75,100,100,100,100,50,50,50,50],
        'sabados': [50,50,50,50,50,50,50,100,100,100,100,100,100,100,75,75,100,100,100,100,50,50,50,50],
        'dom_fer': [50,50,50,50,50,50,50,100,100,100,100,100,100,100,75,75,100,100,100,100,50,50,50,50],
    },
}

# -----------------------------------------------------------------------------
# HOTÉIS 4-5 ESTRELAS (usa estações)
# -----------------------------------------------------------------------------
PERFIS_RSECE['Hotel 4-5 Estrelas'] = {
    'ocupacao': {
        'seg_sex': [95,95,95,95,95,95,75,50,50,30,30,35,45,45,45,40,50,55,60,75,75,85,95,95],  # Primavera
        'sabados': [90,90,90,90,90,90,75,55,40,20,20,30,45,45,35,25,35,40,45,55,60,70,80,90],  # Verão
        'dom_fer': [100,100,100,100,100,100,70,45,45,25,25,30,40,40,40,35,45,50,60,75,75,85,100,100],  # Outono
    },
    'iluminacao': {
        'seg_sex': [90,65,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,65,85,90,90,90,90,90],
        'sabados': [90,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,55,70,90,90,90,90],
        'dom_fer': [95,75,50,45,45,45,45,45,45,45,45,45,45,45,45,45,45,70,90,95,100,100,100,100],
    },
    'equipamento': {
        'seg_sex': [100,75,50,45,45,45,55,60,70,75,80,70,55,70,80,75,65,60,65,75,100,100,100,100],
        'sabados': [100,65,50,50,50,50,55,65,70,80,90,80,55,65,75,80,75,70,60,65,80,90,100,100],
        'dom_fer': [100,75,60,55,55,55,65,65,70,80,90,80,65,75,85,90,75,65,70,95,100,100,100,100],
    },
}

# -----------------------------------------------------------------------------
# HOTÉIS 3 OU MENOS ESTRELAS
# -----------------------------------------------------------------------------
PERFIS_RSECE['Hotel 1-3 Estrelas'] = {
    'ocupacao': {
        'seg_sex': [95,95,95,95,95,95,65,40,20,25,25,20,15,25,25,25,15,20,20,25,45,55,85,95],
        'sabados': [90,90,90,90,90,90,60,20,20,20,20,15,15,20,20,20,15,20,25,35,45,70,80,90],
        'dom_fer': [100,100,100,100,100,100,35,30,25,25,25,20,20,25,25,25,20,25,20,30,40,55,85,100],
    },
    'iluminacao': {
        'seg_sex': [90,65,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,65,85,90,90,90,90,90],
        'sabados': [90,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,55,70,90,90,90,90],
        'dom_fer': [95,75,50,45,45,45,45,45,45,45,45,45,45,45,45,45,45,70,90,95,100,100,100,100],
    },
    'equipamento': {
        'seg_sex': [10,10,10,10,10,10,55,60,70,75,80,70,55,70,80,75,65,60,65,75,100,100,100,10],
        'sabados': [10,10,10,10,10,10,55,65,70,80,90,80,55,65,75,80,75,70,60,65,80,90,100,10],
        'dom_fer': [10,10,10,10,10,10,65,65,70,80,90,80,65,75,85,90,75,65,70,95,100,100,100,10],
    },
}

# -----------------------------------------------------------------------------
# CINEMAS E TEATROS
# -----------------------------------------------------------------------------
PERFIS_RSECE['Cinema Teatro'] = {
    'ocupacao': {
        'seg_sex': [70,25,0,0,0,0,0,0,0,0,0,0,0,5,5,25,30,35,55,65,80,95,90,85],  # Terça-Quinta
        'sabados': [100,45,0,0,0,0,0,0,0,0,0,0,0,25,25,30,35,40,45,55,70,85,100,100],  # Sex, Sab, Seg
        'dom_fer': [70,25,0,0,0,0,0,0,0,0,0,0,0,5,5,25,30,35,55,65,80,95,90,85],  # Dom e Feriados
    },
    'iluminacao': {
        'seg_sex': [70,25,0,0,0,0,0,0,0,0,0,0,0,5,5,25,30,35,45,65,70,100,90,80],
        'sabados': [100,45,0,0,0,0,0,0,0,0,0,0,0,25,25,25,30,35,40,45,60,90,100,100],
        'dom_fer': [70,25,0,0,0,0,0,0,0,0,0,0,0,5,5,25,30,35,45,65,70,100,90,80],
    },
    'equipamento': {
        'seg_sex': [70,25,0,0,0,0,0,0,0,0,0,0,0,5,5,25,30,35,45,65,70,100,90,80],
        'sabados': [100,45,0,0,0,0,0,0,0,0,0,0,0,25,25,25,30,35,40,45,60,90,100,100],
        'dom_fer': [70,25,0,0,0,0,0,0,0,0,0,0,0,5,5,25,30,35,45,65,70,100,90,80],
    },
}

# -----------------------------------------------------------------------------
# DISCOTECAS
# -----------------------------------------------------------------------------
PERFIS_RSECE['Discoteca'] = {
    'ocupacao': {
        'seg_sex': [90,90,85,65,35,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,30,55,80],  # Terça-Quarta
        'sabados': [95,100,100,100,85,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,25,60,90],  # Qui-Dom e Feriados
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],  # Segundas (encerrado)
    },
    'iluminacao': {
        'seg_sex': [100,100,100,100,85,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,35,50,80,100],
        'sabados': [100,100,100,100,85,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,35,50,80,100],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'equipamento': {
        'seg_sex': [100,100,100,100,85,65,15,0,0,0,0,0,0,0,0,0,0,0,0,0,35,60,75,100],
        'sabados': [100,100,100,100,85,65,15,0,0,0,0,0,0,0,0,0,0,0,0,0,35,60,75,100],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
}

# -----------------------------------------------------------------------------
# BINGOS E CLUBES SOCIAIS
# -----------------------------------------------------------------------------
PERFIS_RSECE['Bingo Clube Social'] = {
    'ocupacao': {
        'seg_sex': [80,65,0,0,0,0,0,0,0,0,0,0,0,0,0,35,40,45,55,55,55,60,80,80],
        'sabados': [100,80,0,0,0,0,0,0,0,0,0,0,0,0,0,35,40,45,55,65,75,80,100,100],
        'dom_fer': [100,80,0,0,0,0,0,0,0,0,0,0,0,0,0,35,40,45,55,65,75,80,100,100],
    },
    'iluminacao': {
        'seg_sex': [100,75,0,0,0,0,0,0,0,0,0,0,0,0,0,45,55,60,65,80,90,100,100,100],
        'sabados': [100,75,0,0,0,0,0,0,0,0,0,0,0,0,0,45,55,60,65,80,90,100,100,100],
        'dom_fer': [100,75,0,0,0,0,0,0,0,0,0,0,0,0,0,45,55,60,65,80,90,100,100,100],
    },
    'equipamento': {
        'seg_sex': [100,50,0,0,0,0,0,0,0,0,0,0,0,0,0,20,25,35,45,60,75,85,95,100],
        'sabados': [100,50,0,0,0,0,0,0,0,0,0,0,0,0,0,20,25,35,45,60,75,85,95,100],
        'dom_fer': [100,50,0,0,0,0,0,0,0,0,0,0,0,0,0,20,25,35,45,60,75,85,95,100],
    },
}

# -----------------------------------------------------------------------------
# CLUBES DESPORTIVOS COM PISCINA
# -----------------------------------------------------------------------------
PERFIS_RSECE['Clube Desp Piscina'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,0,0,25,75,75,100,100,100,100,100,100,100,100,100,100,50,0,0,0],
        'sabados': [0,0,0,0,0,0,0,25,75,75,100,100,100,100,100,100,100,100,100,100,50,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'iluminacao': {
        'seg_sex': [0,0,0,0,0,0,0,15,40,45,45,45,35,70,80,90,95,100,50,45,45,30,0,0],
        'sabados': [0,0,0,0,0,0,0,15,40,45,45,45,35,70,80,90,95,100,50,45,45,30,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'equipamento': {
        'seg_sex': [0,0,0,0,0,0,0,15,40,45,45,45,35,70,80,90,95,100,50,45,45,30,0,0],
        'sabados': [0,0,0,0,0,0,0,15,40,45,45,45,35,70,80,90,95,100,50,45,45,30,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
}

# -----------------------------------------------------------------------------
# CLUBES DESPORTIVOS SEM PISCINA
# -----------------------------------------------------------------------------
PERFIS_RSECE['Clube Desportivo'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,0,0,15,35,40,55,55,40,100,100,100,100,75,50,50,50,35,10,0],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'iluminacao': {
        'seg_sex': [0,0,0,0,0,0,0,15,40,45,45,45,35,70,80,90,95,100,50,45,45,30,20,0],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'equipamento': {
        'seg_sex': [0,0,0,0,0,0,0,15,40,45,45,45,35,70,80,90,95,100,50,45,45,30,0,0],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
}

# -----------------------------------------------------------------------------
# ESCRITÓRIOS
# -----------------------------------------------------------------------------
PERFIS_RSECE['Escritorio'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,0,10,20,50,90,100,100,50,70,90,100,80,50,20,10,0,0,0,0],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'iluminacao': {
        'seg_sex': [5,5,5,5,5,5,10,30,75,85,100,100,50,85,95,100,95,50,30,25,5,5,5,5],
        'sabados': [5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],
        'dom_fer': [5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],
    },
    'equipamento': {
        'seg_sex': [15,15,15,15,15,15,30,70,85,95,100,95,70,70,95,100,90,70,45,25,15,15,15,15],
        'sabados': [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],
        'dom_fer': [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],
    },
}

# -----------------------------------------------------------------------------
# SEDE DE BANCOS E SEGURADORAS
# -----------------------------------------------------------------------------
PERFIS_RSECE['Banco Sede'] = {
    'ocupacao': {
        'seg_sex': [5,5,5,5,5,5,25,85,95,100,100,95,95,90,95,100,100,70,50,40,20,10,5,5],
        'sabados': [5,5,5,5,5,5,5,10,25,30,35,25,15,5,10,15,10,5,5,5,5,5,5,5],
        'dom_fer': [5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],
    },
    'iluminacao': {
        'seg_sex': [15,15,15,15,15,15,60,85,90,100,100,95,90,95,95,100,100,65,50,40,30,25,15,15],
        'sabados': [15,15,15,15,15,15,15,20,25,35,45,35,20,20,35,35,25,15,15,15,15,15,15,15],
        'dom_fer': [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],
    },
    'equipamento': {
        'seg_sex': [35,35,35,35,35,35,70,80,90,100,100,95,90,95,95,100,100,65,45,45,45,45,35,35],
        'sabados': [35,35,35,35,35,35,40,65,75,90,80,60,55,55,65,65,40,40,35,35,35,35,35,35],
        'dom_fer': [35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35],
    },
}

# -----------------------------------------------------------------------------
# FILIAIS DE BANCOS E SEGURADORAS
# -----------------------------------------------------------------------------
PERFIS_RSECE['Banco Filial'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,0,25,85,95,100,100,95,95,90,95,100,100,70,50,40,20,10,0,0],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'iluminacao': {
        'seg_sex': [0,0,0,0,0,0,60,85,90,100,100,95,90,95,95,100,100,65,50,40,30,25,0,0],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'equipamento': {
        'seg_sex': [10,10,10,10,10,10,70,80,90,100,100,95,90,95,95,100,100,65,35,35,25,20,10,10],
        'sabados': [10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],
        'dom_fer': [10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],
    },
}

# -----------------------------------------------------------------------------
# COMUNICAÇÕES
# -----------------------------------------------------------------------------
PERFIS_RSECE['Comunicacoes'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,0,10,20,95,100,100,100,50,100,100,100,100,100,80,55,40,10,5,5],
        'sabados': [0,0,0,0,0,0,10,10,30,30,30,30,10,10,10,10,10,5,5,5,5,5,5,5],
        'dom_fer': [0,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,0,0,0,0,0,0],
    },
    'iluminacao': {
        'seg_sex': [30,30,30,30,30,40,60,70,80,90,100,80,10,10,70,90,80,65,50,50,35,30,30,30],
        'sabados': [30,30,30,30,30,30,45,50,55,60,70,65,50,50,55,55,55,45,30,30,30,30,30,30],
        'dom_fer': [30,30,30,30,30,30,30,10,5,5,5,5,5,5,5,5,5,5,5,5,15,30,30,30],
    },
    'equipamento': {
        'seg_sex': [30,30,30,30,30,40,50,65,75,100,100,95,40,40,70,95,85,60,55,50,30,30,30,30],
        'sabados': [30,30,30,30,30,30,45,50,55,60,70,65,50,50,55,55,55,45,30,30,30,30,30,30],
        'dom_fer': [30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30],
    },
}

# -----------------------------------------------------------------------------
# BIBLIOTECAS
# -----------------------------------------------------------------------------
PERFIS_RSECE['Biblioteca'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,0,0,5,15,90,100,95,80,90,100,95,15,5,0,0,0,0,0,0],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'iluminacao': {
        'seg_sex': [30,30,30,30,30,40,60,70,80,99,100,80,10,10,70,90,80,65,50,50,35,30,30,30],
        'sabados': [30,30,30,30,30,30,30,30,5,25,30,25,5,5,25,30,25,5,5,5,15,30,30,30],
        'dom_fer': [30,30,30,30,30,30,30,10,5,5,5,5,5,5,5,5,5,5,5,5,15,30,30,30],
    },
    'equipamento': {
        'seg_sex': [30,30,30,30,30,40,50,65,75,100,100,95,40,40,70,95,85,60,55,50,30,30,30,30],
        'sabados': [30,30,30,30,30,30,45,50,55,60,70,65,50,50,55,55,55,45,30,30,30,30,30,30],
        'dom_fer': [30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30],
    },
}

# -----------------------------------------------------------------------------
# MUSEUS E GALERIAS
# -----------------------------------------------------------------------------
PERFIS_RSECE['Museu Galeria'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,0,0,5,10,65,90,90,75,85,90,85,15,5,0,0,0,0,0,0],
        'sabados': [0,0,0,0,0,0,0,5,15,90,100,95,80,90,100,95,15,5,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,5,15,90,100,95,80,90,100,95,15,5,0,0,0,0,0,0],
    },
    'iluminacao': {
        'seg_sex': [0,0,0,0,0,0,0,5,40,90,100,95,90,90,100,100,10,5,0,0,0,0,0,0],
        'sabados': [0,0,0,0,0,0,0,5,40,90,100,95,90,90,100,100,10,5,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,5,40,90,100,95,90,90,100,100,10,5,0,0,0,0,0,0],
    },
    'equipamento': {
        'seg_sex': [0,0,0,0,0,0,0,5,40,100,90,85,80,80,80,80,10,0,0,0,0,0,0,0],
        'sabados': [0,0,0,0,0,0,0,5,40,100,90,85,80,80,80,80,10,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,5,40,100,90,85,80,80,80,80,10,0,0,0,0,0,0,0],
    },
}

# -----------------------------------------------------------------------------
# TRIBUNAIS, MINISTÉRIOS E CÂMARAS
# -----------------------------------------------------------------------------
PERFIS_RSECE['Tribunal Camara'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,0,5,10,55,70,80,100,15,35,100,80,65,20,0,0,0,0,0,0],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'iluminacao': {
        'seg_sex': [0,0,0,0,0,0,5,10,70,80,95,100,40,50,100,80,60,40,0,0,0,0,0,0],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'equipamento': {
        'seg_sex': [0,0,0,0,0,0,5,10,70,80,95,100,40,50,100,80,60,40,0,0,0,0,0,0],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
}

# -----------------------------------------------------------------------------
# ESTABELECIMENTOS PRISIONAIS
# -----------------------------------------------------------------------------
PERFIS_RSECE['Prisao'] = {
    'ocupacao': {
        'seg_sex': [90,90,90,90,90,90,90,90,90,90,90,90,90,90,100,100,100,90,90,90,90,90,90,90],
        'sabados': [90,90,90,90,90,90,90,90,90,90,90,90,90,90,100,100,100,90,90,90,90,90,90,90],
        'dom_fer': [90,90,90,90,90,90,90,90,90,90,90,90,90,90,100,100,100,90,90,90,90,90,90,90],
    },
    'iluminacao': {
        'seg_sex': [5,5,5,5,5,5,95,95,55,55,55,55,55,55,100,100,100,100,100,5,5,5,5,5],
        'sabados': [5,5,5,5,5,5,95,95,55,55,55,55,55,55,100,100,100,100,100,5,5,5,5,5],
        'dom_fer': [5,5,5,5,5,5,95,95,55,55,55,55,55,55,100,100,100,100,100,5,5,5,5,5],
    },
    'equipamento': {
        'seg_sex': [5,5,5,5,5,5,100,100,5,5,100,100,100,5,5,5,5,100,100,5,5,5,5,5],
        'sabados': [5,5,5,5,5,5,100,100,5,5,100,100,100,5,5,5,5,100,100,5,5,5,5,5],
        'dom_fer': [5,5,5,5,5,5,100,100,5,5,100,100,100,5,5,5,5,100,100,5,5,5,5,5],
    },
}

# -----------------------------------------------------------------------------
# ESTABELECIMENTOS DE ENSINO (Básico/Secundário)
# -----------------------------------------------------------------------------
PERFIS_RSECE['Escola'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,0,0,0,5,90,100,100,100,90,90,100,100,100,80,10,0,0,0,0],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'iluminacao': {
        'seg_sex': [0,0,0,0,0,0,0,0,15,95,100,100,95,80,80,100,100,90,70,15,0,0,0,0],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'equipamento': {
        'seg_sex': [0,0,0,0,0,0,0,0,15,95,100,100,95,80,80,100,100,90,70,15,0,0,0,0],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
}

# -----------------------------------------------------------------------------
# ESTABELECIMENTOS DE ENSINO SUPERIOR
# -----------------------------------------------------------------------------
PERFIS_RSECE['Universidade'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,0,0,5,80,85,100,95,45,70,95,100,90,50,10,10,10,10,10,10],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'iluminacao': {
        'seg_sex': [0,0,0,0,0,0,0,15,85,90,100,95,45,60,100,95,80,40,10,10,10,10,10,10],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'equipamento': {
        'seg_sex': [0,0,0,0,0,0,0,15,85,90,100,95,45,60,100,95,80,40,10,10,10,10,10,10],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
}

# -----------------------------------------------------------------------------
# SAÚDE SEM INTERNAMENTO
# -----------------------------------------------------------------------------
PERFIS_RSECE['Saude Sem Intern'] = {
    'ocupacao': {
        'seg_sex': [0,0,0,0,0,0,0,50,100,100,100,100,100,100,100,100,100,50,25,25,25,25,25,25],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'iluminacao': {
        'seg_sex': [0,0,0,0,0,0,0,50,100,100,100,100,100,100,100,100,100,50,10,10,10,10,10,10],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
    'equipamento': {
        'seg_sex': [0,0,0,0,0,0,0,50,100,100,100,100,100,100,100,100,100,50,35,35,35,35,35,35],
        'sabados': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        'dom_fer': [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    },
}

# -----------------------------------------------------------------------------
# SAÚDE COM INTERNAMENTO
# -----------------------------------------------------------------------------
PERFIS_RSECE['Saude Com Intern'] = {
    'ocupacao': {
        'seg_sex': [50,50,50,50,50,50,50,50,100,100,100,100,100,100,100,100,100,50,50,50,50,50,50,50],
        'sabados': [50,50,50,50,50,50,50,50,100,100,100,100,100,100,100,100,100,50,50,50,50,50,50,50],
        'dom_fer': [50,50,50,50,50,50,50,50,100,100,100,100,100,100,100,100,100,50,50,50,50,50,50,50],
    },
    'iluminacao': {
        'seg_sex': [10,10,10,10,10,10,45,50,100,100,100,100,100,100,100,100,100,50,45,45,10,10,10,10],
        'sabados': [10,10,10,10,10,10,45,50,100,100,100,100,100,100,100,100,100,50,45,45,10,10,10,10],
        'dom_fer': [10,10,10,10,10,10,45,50,100,100,100,100,100,100,100,100,100,50,45,45,10,10,10,10],
    },
    'equipamento': {
        'seg_sex': [35,35,35,35,35,35,35,50,100,100,100,100,100,100,100,100,100,50,35,35,35,35,35,35],
        'sabados': [35,35,35,35,35,35,35,50,100,100,100,100,100,100,100,100,100,50,35,35,35,35,35,35],
        'dom_fer': [35,35,35,35,35,35,35,50,100,100,100,100,100,100,100,100,100,50,35,35,35,35,35,35],
    },
}


# =============================================================================
# FUNÇÕES DE CRIAÇÃO DE SCHEDULES
# =============================================================================

def criar_schedule_rsece(nome_tipologia: str, tipo_perfil: str) -> HAPSchedule:
    """
    Cria um schedule HAP a partir dos dados RSECE.

    Args:
        nome_tipologia: Nome da tipologia (ex: 'Escritorio', 'Hipermercado')
        tipo_perfil: 'ocupacao', 'iluminacao' ou 'equipamento'

    Returns:
        HAPSchedule configurado com os valores RSECE
    """
    if nome_tipologia not in PERFIS_RSECE:
        raise ValueError(f"Tipologia não encontrada: {nome_tipologia}")

    if tipo_perfil not in PERFIS_RSECE[nome_tipologia]:
        raise ValueError(f"Tipo de perfil não encontrado: {tipo_perfil}")

    dados = PERFIS_RSECE[nome_tipologia][tipo_perfil]

    # Nome do schedule (max 24 chars)
    tipo_abrev = {'ocupacao': 'Ocup', 'iluminacao': 'Ilum', 'equipamento': 'Equip'}[tipo_perfil]
    schedule_name = f"{nome_tipologia[:17]} {tipo_abrev}"[:24]

    return create_simple_schedule(
        name=schedule_name,
        weekday_values=dados['seg_sex'],
        weekend_values=dados['sabados'],
        holiday_values=dados['dom_fer']
    )


def criar_todos_schedules_rsece() -> List[HAPSchedule]:
    """
    Cria todos os schedules RSECE (ocupação, iluminação, equipamento para cada tipologia).

    Returns:
        Lista de HAPSchedule
    """
    schedules = []

    for tipologia in PERFIS_RSECE:
        for tipo_perfil in ['ocupacao', 'iluminacao', 'equipamento']:
            try:
                schedule = criar_schedule_rsece(tipologia, tipo_perfil)
                schedules.append(schedule)
                print(f"  Criado: {schedule.name}")
            except Exception as e:
                print(f"  ERRO ao criar {tipologia}/{tipo_perfil}: {e}")

    return schedules


def guardar_schedules_em_e3a(schedules: List[HAPSchedule], modelo_path: str, output_path: str):
    """
    Guarda os schedules num ficheiro .E3A.

    Args:
        schedules: Lista de schedules a guardar
        modelo_path: Caminho do ficheiro modelo (para copiar estrutura)
        output_path: Caminho do ficheiro de saída
    """
    import tempfile
    import shutil

    # Extrair modelo para pasta temporária
    temp_dir = tempfile.mkdtemp()

    try:
        with zipfile.ZipFile(modelo_path, 'r') as zf:
            zf.extractall(temp_dir)

        # Criar novo HAP51SCH.DAT
        sch_data = bytearray()

        # Primeiro schedule é o Sample
        sample = HAPSchedule()
        sample.name = 'Sample Schedule'
        sch_data.extend(encode_schedule(sample))

        # Adicionar todos os novos schedules
        for schedule in schedules:
            sch_data.extend(encode_schedule(schedule))

        # Escrever HAP51SCH.DAT
        sch_path = os.path.join(temp_dir, 'HAP51SCH.DAT')
        with open(sch_path, 'wb') as f:
            f.write(bytes(sch_data))

        # Actualizar MDB com os nomes dos schedules
        print("\nActualizando ScheduleIndex no MDB...")
        try:
            import pyodbc
            mdb_path = os.path.join(temp_dir, 'HAP51INX.MDB')
            conn_str = f'DRIVER={{Microsoft Access Driver (*.mdb, *.accdb)}};DBQ={mdb_path};'
            conn = pyodbc.connect(conn_str)
            cursor = conn.cursor()

            # Limpar ScheduleIndex existente
            cursor.execute("DELETE FROM ScheduleIndex")

            # Inserir Sample Schedule (índice 1)
            cursor.execute("INSERT INTO ScheduleIndex (nIndex, szName) VALUES (1, 'Sample Schedule')")

            # Inserir todos os schedules RSECE (índice 2 em diante)
            for i, schedule in enumerate(schedules):
                sch_id = i + 2
                name = schedule.name[:24]
                cursor.execute(f"INSERT INTO ScheduleIndex (nIndex, szName) VALUES ({sch_id}, '{name}')")

            conn.commit()
            conn.close()
            print(f"  ScheduleIndex: {len(schedules) + 1} registos")

        except ImportError:
            print("  AVISO: pyodbc não disponível, MDB não actualizado")
        except Exception as e:
            print(f"  ERRO ao actualizar MDB: {e}")

        # Criar ficheiro ZIP final
        with zipfile.ZipFile(output_path, 'w', zipfile.ZIP_DEFLATED) as zf:
            for root, dirs, files_list in os.walk(temp_dir):
                for file in files_list:
                    file_path = os.path.join(root, file)
                    arcname = os.path.relpath(file_path, temp_dir)
                    zf.write(file_path, arcname)

        print(f"\nFicheiro guardado: {output_path}")
        print(f"Total schedules: {len(schedules) + 1} (incluindo Sample)")

    finally:
        shutil.rmtree(temp_dir, ignore_errors=True)


# =============================================================================
# MAIN
# =============================================================================

def main():
    print("=" * 60)
    print("CRIAÇÃO DE PERFIS RSECE PARA HAP 5.1")
    print("=" * 60)
    print()

    if len(sys.argv) < 3:
        print("Usage: python criar_perfis_rsece.py <modelo.E3A> <output.E3A>")
        print()
        print("Exemplo:")
        print("  python criar_perfis_rsece.py VF_final.E3A Modelo_RSECE.E3A")
        print()
        print("Tipologias disponíveis:")
        for i, tipologia in enumerate(PERFIS_RSECE.keys(), 1):
            print(f"  {i:2}. {tipologia}")
        print()
        print(f"Total: {len(PERFIS_RSECE)} tipologias × 3 perfis = {len(PERFIS_RSECE)*3} schedules")
        return

    modelo_path = sys.argv[1]
    output_path = sys.argv[2]

    if not os.path.exists(modelo_path):
        print(f"ERRO: Ficheiro modelo não encontrado: {modelo_path}")
        return

    print(f"Modelo: {modelo_path}")
    print(f"Output: {output_path}")
    print()
    print("Criando schedules RSECE...")
    print()

    # Criar todos os schedules
    schedules = criar_todos_schedules_rsece()

    print()
    print(f"Total criados: {len(schedules)} schedules")

    # Guardar
    guardar_schedules_em_e3a(schedules, modelo_path, output_path)

    print()
    print("NOTA: Os nomes no HAP aparecem do MDB, não do DAT.")
    print("      Precisas atualizar o MDB separadamente se quiseres")
    print("      que os nomes apareçam corretamente no HAP.")


if __name__ == '__main__':
    main()
